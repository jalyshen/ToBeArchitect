# Serverless无服务器架构

原文：https://www.jdon.com/soa/serverless.html



Serverless不代表再也不需要服务器了，而是说：开发者再也不用过多考虑服务器的问题，计算资源作为服务而不是服务器的概念出现。Serverless是一种构建和管理基于微服务架构的完整流程，允许你在服务部署级别而不是服务器部署级别来管理你的应用部署，你甚至可以管理某个具体功能或端口的部署，这就能让开发者快速迭代，更快速地开发软件。

以亚马逊的AWS Lambda为案例，Lambda能让不用思考任何服务器，也就是说，不用你处理服务器上的部署、服务器容量和服务器的扩展和失败容错，还有服务器上选择什么OS操作系统，语言的更新，日志等等问题。你的应用程序只需要和多个第三方的API或服务打交道，也可以自我创建一个无服务器的API。

Serverless有以下几个特点：

* Serverless意味无维护，Serverless不代表完全去除服务器，而是代表去除有关对服务器运行状态的关心和担心，它们是否在工作，应用是否跑起来正常运行等等。Serverless代表的是你不要关心运营维护问题。有了Serverless，可以几乎无需Devops了
* Serverless不代表某个具体技术，有些人会给他们的语言框架取名为Serverless，Serverless其实去除维护的担心，如果你了解某个具体服务器技术当然有帮助，但不是必须的
* Serverless中的服务或功能代表的只是微功能或微服务，Serverless是思维方式的转变，从过去：“构建一个框架运行在一台服务器上，对多个事件进行响应。”变为：“构建或使用一个微服务或微功能来响应一个事件。”，你可以使用 django or node.js 和express等实现，但是serverless本身超越这些框架概念。框架变得也不那么重要了



Serverless规模扩展性方面由于充分利用云计算的特点，因此其扩展是平滑的，同时由于Serverless是基于微服务的，而一些微功能微服务的云计算是零收费，这样有助于降低整体运营费用。

将来下述具体应用将可能使用Serverless架构：

- 静态网站的管理
- 替代WordPress([Serverless Blog Project](https://github.com/serverless/serverless-graphql-blog))
- 个人媒体服务器(less!)
- 物联网Iot或家庭自动框架或项目 (使用 [AWS IoT](https://aws.amazon.com/iot/))



### 无服务器架构

无服务器架构是传统的云计算平台延申，是 PaaS向更细粒度的BaaS和FaaS的发展，Serverless=BaaS+FaaS+...！ Serverless 真正实现了当初云计算的目标！

BaaS是后端即服务，FaaS是函数即服务！根据Martin Fowler网站[无服务器架构定](https://martinfowler.com/articles/serverless.html)义：

1. BaaS：无服务器首先用于描述显着或完全包含第三方云托管应用程序和服务的应用程序，以管理服务器端逻辑和状态。这些通常是“富客户端”应用程序 - 认为单页网络应用程序或移动应用程序 - 使用庞大的云可访问数据库生态系统（例如，Parse，Firebase），身份验证服务（例如，Auth0，AWS Cognito），以及等等。这些类型的服务以前被描述为“ [后端即服务](https://en.wikipedia.org/wiki/Mobile_backend_as_a_service) ”。
2. FaaS：无服务器也可以指服务器端逻辑仍然由应用程序开发人员编写的应用程序，但是，与传统体系结构不同，它在无状态计算容器中运行，这些容器是事件触发的，短暂的（可能只持续一次调用），并且完全由第三方。想到这一点的一种方法是“作为服务的功能”或 “FaaS”。[AWS Lambda](https://aws.amazon.com/lambda/)是目前功能即服务平台最受欢迎的实现之一，但还有很多其他也是。

Serverless是在传统容器技术和[#服务网格](https://www.jdon.com/tags/35688)上发展起来，更侧重让使用者只关注自己的业务逻辑即可。

2018年Google推出Serverless世界的利器：[#Knative](https://www.jdon.com/tags/35996) ，可在任何公有私有云上实现无服务器架构，这样用户使用无服务器编程可以不限于特定的云平台如亚马逊AWS。



### Serverless的典型应用有哪些？

**事件请求场景**

- 定制图片

  网店店家进行商品图片维护时，需要根据商品陈列位置，将图片动态切割成不同尺寸，或者打上不同水印。当店家把图片上传到[对象存储 OSS](https://www.aliyun.com/product/oss)上，会通过[函数计算](https://www.aliyun.com/product/fc)上定制的trigger来触发函数计算。根据计算规则，生成不同尺寸的图片，满足在线商品陈列需求，整个过程无需再搭建额外服务器，也无需网站美工干预。

- 物联网中的低频请求

  物联网行业中，物联网设备传输数据量小，且往往是以固定时间间隔进行数据传输，因此经常涉及低频请求场景。例如：物联网应用程序每分钟仅运行一次，每次运行 50ms，这意味着CPU的使用率仅为 0.1%/小时，或者说有 1000 个相同的应用可以共享计算资源。而Serverless架构下，用户可以购买每分钟 100ms 的资源来满足计算需求，既能有效解决效率问题，也能降低使用成本。

- 定制事件

  用户注册时发邮件验证邮箱地址，同样可以通过定制的事件来触发后续的注册流程，而无需再配置额外的应用无服务器来处理后续的请求。

- 固定时间触发

  事件触发固定时间触发，例如在夜间或者服务空闲时间来处理繁忙时候的交易数据，或者运行批量数据，来生成数据报表，通过Serverless方式，不用再额外购买利用率并不高的处理资源。

  

**流量突发场景**

- 弹性扩展应对突发流量

  移动互联网应用经常会面对突发流量场景。例如：移动应用的通常流量情况是 QPS 20，但每隔 5 分钟会有一个持续 10s 的 QPS 200 流量（10 倍于通常流量）。传统架构下，企业必须扩展 QPS 200 的硬件能力来应对业务高峰，即使高峰时间仅占整个运行时间的4%。

  在Serverless架构下，您可以利用弹性扩展特性，快速构建新的计算能力来满足当前需求，当业务高峰后，资源能够自动释放，有效节省成本。

- 转码和流量扩容

  视频直播某次专场活动，由于无法预估会有多少点播的观众视频接入，把转码和流量扩容这部分内容通过Function来处理，无需考虑并发和流量扩容。