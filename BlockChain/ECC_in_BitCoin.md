# 比特币中使用的加密算法ECC

原文：https://zhuanlan.zhihu.com/p/101907402

群论： https://baike.baidu.com/item/群论

数学公式：https://blog.csdn.net/mingzhuo_126/article/details/82722455

​                     https://www.cnblogs.com/muyisir/p/11440164.html



​        椭圆曲线加密算法，简称ECC，是基于椭圆曲线数学理论实现的一种非对称加密算法。相比RSA，ECC优势是可以使用更短的密钥，来实现与RSA相当或更高的安全，RSA加密算法也是一种非对称加密算法，在公开密钥加密和电子商业中RSA被广泛使用。据研究，160位ECC加密安全性相当于1024位RSA加密，210位ECC加密安全性相当于2048位RSA加密（有待考证）。

​         比特币Bitcoin使用了 ***secp256k1*** 这条特殊的椭圆曲线：
$$
y^2 = x^3 + 7
$$


## Abel群 

​        Abel群，是***群论***里一个特殊的群。如果想进一步了解“**群论**”，可以找机会聊聊。这里先介绍***Abel群***的概念。可以通过这个简单介绍，对**群**有个简单了解。

​        椭圆曲线也可以有**运算**，像实数的加减乘除一样，这就需要使用到“**加群**”。19世纪的挪威数学家*尼尔斯-阿贝尔*抽象出了加群（又叫做阿贝尔群，或交换群）。数学中的群，是一个集合，可以为它定义“加法”，并用符号“+”表示。

### Abel群的定义

​        Abel群是一个**加法群**，假设用**G**表示，则Abel群必须遵循如下的5个特性：

* **封闭性**：如果有 $$a, b \in G$$,  那么 $$a + b \in G$$
  
* **结合律**：对于任何元素a, b, c，都有$$(a + b) + c = a + (b + c)$$ 成立
  
* **交换律**：对于任意的两个元素$$a, b \in G $$，都有$$a + b = b + a$$ 成立
  
* **单位元**：设存在一个$$ e \in G$$，对于任意的 $$a \in G$$，满足：$$ a + e = e + a = a $$， 则这个$$e$$，就是这个群的单位元
  
* **逆元**：对于任意的元素 $$ a \in G $$，必定存在一个元素 $$ b \in G $$，使得 $$ a + b = e $$ 成立

## 椭圆曲线的加法

​        椭圆曲线上两个点的加法是这样定义的：过曲线上的两点A、B，画一条直线。找到这条直线与椭圆曲线的交点，然后找到这个交点关于X轴对称位置的点C，这个点C就被定义为A + B，即椭圆曲线上两点的加法，记作： A + B = C。这个过程如下图所示：

![ecc_add_definition](./images/ECC_in_BitCoin/ecc_add_definition.jpg)

## 椭圆曲线的二倍运算

​        上面定义的加法针对的是位于椭圆曲线上两个不同的点，对于同一个点（或者2个重合点）的“相加”没有做出定义，即A + A没有定义。

​        这种情况下，将椭圆曲线在A点的切线与椭圆曲线的交点，交点关于X轴对称位置的点，定义为A + A，即2A，二倍运算。如下图所示：

![ec_2times_definition](./images/ECC_in_BitCoin/ecc_2times_definition.jpg)

## 同余运算

​        同余就是有相同的余数。两个整数a、b，若它们除以正整数m，所得到的余数相等，则称a、b对于模m同余。数学公式如下：

​        $$ a \equiv b (modm)$$

## 有限域

​        **椭圆曲线是连续的，并不适合用于加密**。所以，必须把椭圆曲线变成离散的点。要把椭圆曲线定义在有限域上。

​        椭圆曲线密码所使用的椭圆曲线是定义在有限域内，有限域最常见的例子是有限域GF(p)，指给定某质数p，由0,1,2 ... p-1共p个元素组成的整数集合中加法、二倍运算。例如：GF(233)就是：$$ y^2 = (x^3 + y)(mod233)$$

## 乘法逆元

​        这里使用**模7乘法**来做示例。这个例子的群$$G=[1,2,3,4,5,6]$$，单位元是$$1$$：

* 1的逆元为 1 :  (1 * 1)%7 = 1
* 2的逆元为4 : (2 * 4)%7 = 1
* 3的逆元为5 : (3 * 5)%7 = 1
* 4的逆元为2 : (4 * 2)%7 = 1
* 5的逆元为3 : (5 * 3)%7 = 1
* 6的逆元为6 : (6 * 6)%7 = 1

​        从这个例子，可以看出“逆元”的定义：群$$G$$中任意一个元素$$a$$，都在$$G$$中有唯一的元素$$a'$$，使得 $$aa' = a'a = e$$, 其中$$e$$是群的单位元。

## 数学解释



## 椭圆曲线加密算法原理



## 椭圆曲线签名算法原理



## 签名过程



## 验证过程



## 数值计算Demo

